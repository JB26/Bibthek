<%include file="header.html" />
<%include file="menu.html" />
    <link rel="stylesheet" href="/static/css/sidebar.css" type="text/css" />
    <div class="container">
      <form method="post" action="/save${'?book_id=' + book['_id']}" enctype="multipart/form-data" id="book_form" class="form-horizontal">
        <input type="text" id="type" name="type" value="${book['type']}" style="display:none">
        <div class="row">
          <div class="col-md-3">
            <div class="form-group">
              <label for="isbn" class="col-sm-2 control-label">ISBN</label>
              <div class="col-sm-10">
                <input class="form-control" type="text" id="isbn" name="isbn" value="${book['isbn']}"/>
              </div>
            </div>
          </div>
          <div class="col-md-9">
            <div class="form-group">
              <label for="title" class="col-sm-2 control-label">Title</label>
              <div class="col-sm-10">
                <input class="form-control" type="text" id="title" name="title" value="${book['title'] | h}" />
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-3">
            <img src="/${book['front']}" alt="Cover" width="100%" id="cover">
          </div>
          <div class="col-md-9">
            <div class="row">
              <div class="col-md-12">
                <div class="form-group">
                  <label for="authors" class="col-sm-2 control-label">Author</label>
                  <div class="col-sm-10">
                    <input class="form-control" type="text" id="authors" name="authors" value="${book['authors'] | h}">
                  </div>
                </div>
              </div>
            </div>
            % if book['type'] == 'comic':
            <div class='comic' style="display:block">
            % else:
            <div class='comic' style="display:none">
            % endif
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <label for="artist" class="col-sm-2 control-label">Artist</label>
                    <div class="col-sm-10">
                      <input class="form-control" type="text" id="artist" name="artist" value="${book['artist'] | h}">
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-7">
                  <div class="form-group">
                    <label for="colorist" class="col-sm-4 control-label">Colorist</label>
                    <div class="col-sm-8">
                      <input class="form-control" type="text" id="colorist" name="colorist" value="${book['colorist'] | h}">
                    </div>
                  </div>
                </div>
                <div class="col-md-5">
                  <div class="form-group">
                    <label for="cover_artist" class="col-sm-4 control-label">Cover Artist</label>
                    <div class="col-sm-8">
                      <input class="form-control" type="text" id="cover_artist" name="cover_artist" value="${book['cover_artist'] | h}">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-7">
                <div class="form-group">
                  <label for="publisher" class="col-sm-4 control-label">Publisher</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="publisher" name="publisher" value="${book['publisher'] | h}">
                  </div>
                </div>
              </div>
              <div class="col-md-5">
                <div class="form-group">
                  <label for="release_date" class="col-sm-4 control-label">Published</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="release_date" name="release_date" value="${book['release_date'] | h}">
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-7">
                <div class="form-group">
                  <label for="series" class="col-sm-4 control-label">Series</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="series" name="series" value="${book['series'] | h}">
                  </div>
                </div>
              </div>
              <div class="col-md-5">
                <div class="form-group">
                  <label for="order" class="col-sm-4 control-label">Order</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="order" name="order" value="${book['order'] | h}">
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-7">
                <div class="form-group">
                  <label for="language" class="col-sm-4 control-label">Language</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="language" name="language" value="${book['language'] | h}">
                  </div>
                </div>
              </div>
              <div class="col-md-5">
                <div class="form-group">
                  <label for="pages" class="col-sm-4 control-label">Pages</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="pages" name="pages" value="${book['pages'] | h}">
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-7">
                <div class="form-group">
                  <label for="genre" class="col-sm-4 control-label">Genre</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="genre" name="genre" value="${book['genre'] | h}">
                  </div>
                </div>
              </div>
              <div class="col-md-5">
                <div class="form-group">
                  <label for="binding" class="col-sm-4 control-label">Binding</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="binding" name="binding" value="${book['binding'] | h}">
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-7">
                <div class="form-group">
                  <label for="shelf" class="col-sm-4 control-label">Shelf</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="shelf" name="shelf" value="${book['shelf'] | h}">
                  </div>
                </div>
              </div>
              <div class="col-md-5">
                <div class="form-group">
                  <label for="add_date" class="col-sm-4 control-label">Date added</label>
                  <div class="col-sm-8">
                    <input class="form-control" type="text" id="add_date" name="add_date" value="${book['add_date'] | h}">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-12">
              <label for="front">Cover</label>
              <input type="file" name="front">
          </div>
        </div>
        <div class="row">
          <div class="col-md-7">
            <h3>Description</h3>
            <textarea class="form-control" id="description" name="description" rows="10">${book['description']}</textarea>
            <button type="submit" name="save">Save!</button>
            % if new == True:
            <button type="submit" name="isbn_search" id="isbn_search" style="display:inline;">ISBN search</button>
            <a href="/delete${'?book_id=' + book['_id']}" id="delete" style="display:none;">Delete!</a>
            % else:
            <button type="submit" name="isbn_search" id="isbn_search" style="display:none;">ISBN search</button>
            <a href="/delete${'?book_id=' + book['_id']}" id="delete" style="display:inline;">Delete!</a>
            % endif
            <br />
            <a href="https://www.google.de/search?q=${book['isbn']}&tbm=isch" id='isbn_image' target="_blank">Cover search</a>
            <a href="/" id='goodreads' target="_blank">GoodReads</a>
            <a href="https://www.amazon.de/gp/search?keywords=${book['isbn']}" id='amazon' target="_blank">Amazon search</a>
          </div>
          <div class="col-md-5">
            <h3>Reading Stats</h3>
            <a href="start_reading" id="start_reading">Start reading</a>
            <a href="delete_reading" id="delete_reading">Delete last</a>
            <table class="table table-striped" id="reading_stats">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Date</th>
                  <th>Abdoned</th>
                </tr>
              </thead>
              <tbody>
                <%
                i = -1
                %>
                % if book['reading_stats'] != None :
                % for i in range(len(book['reading_stats'])):
                <tr> 
                  <th scope="row">${i+1}</th>
                  <td>
                    <div class="form-group">
                      <label for="start_${i+1}" class="col-sm-4 control-label">Started</label>
                      <div class="col-sm-8">
                        <input class="form-control" type="text" name="start_date" id="start_${i+1}" value="${book['reading_stats'][i]['start_date'] | h}">
                      </div>
                    </div>
                    <div class="form-group">
                      <label for="finish_${i+1}" class="col-sm-4 control-label">Finished</label>
                      <div class="col-sm-8">
                        <input class="form-control" type="text" name="finish_date" id="finish_${i+1}" value="${book['reading_stats'][i]['finish_date'] | h}">
                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="checkbox">
                      <label>
                      % if 'abdoned' in book['reading_stats'][i] and book['reading_stats'][i]['abdoned']:
                      <input type="checkbox" name="abdoned" value="${i}" checked> Abdoned
                      % else:
                      <input type="checkbox" name="abdoned" value="${i}"> Abdoned
                      % endif
                      </label>
                    </div>          
                  </td>
                </tr>
                % endfor
                % endif
              </tbody>
            </table>
          </div>
        </div>
      </form>
    </div>  

<script src="/static/js/local.js"></script>
</body>
</html>
